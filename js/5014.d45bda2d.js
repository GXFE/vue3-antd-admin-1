"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[5014],{6957:function(e,t,n){n.a(e,(async function(e,u){try{n(57658);var a=n(66252),l=n(2262),r=n(79697),i=n(65416),o=n(88302),c=n(16635),s=n(70473),d=n(72616),f=n(47297),v=n(64560),h=n(9525),m=e([h]);h=(m.then?(await m)():m)[0];const p={class:"file-upload-drawer-container"},g=(0,a._)("i",{class:"el-icon-upload"},null,-1),w=(0,a._)("div",{class:"el-upload__text"},[(0,a.Uk)("将文件拖到此处，或"),(0,a._)("em",null,"点击上传")],-1),_=(0,a.aZ)({name:"FileUploadDrawer"});t.Z=(0,a.aZ)({..._,emits:["changed"],setup(e,t){let{expose:n,emit:u}=t;const m=(0,l.iH)(),_=(0,l.iH)(!1),W=(0,l.iH)(!1),Z=(0,l.iH)(""),b=(0,l.iH)(""),k=(0,l.iH)([]),y=(0,l.iH)([]),H=(0,l.iH)([]),U=(0,a.Fl)((()=>`上传文件到 ${(0,r.Z)(Z.value)?"根":Z.value.substring(0,Z.value.length-1)} 目录`)),$=()=>{k.value.length>0&&k.value.length!==y.value.length?c.Z.confirm({title:"关闭会取消未上传的文件，确认关闭吗？",icon:(0,a.Wm)(o.Z),onOk:S}):S()},S=()=>{W.value=!1,_.value=!1,Z.value="",b.value="",H.value=[],C()},x=e=>{const{file:t,onProgress:n,onError:u,onSuccess:a}=e,l=i.ws(t,`${Z.value}${t.name}`,b.value).subscribe({next:e=>{null==n||n({percent:e.total.percent})},error:e=>{null==u||u(e),D(e,t)},complete:e=>{y.value.push(l),null==a||a(e),F(t)}});k.value.push(l)},D=(e,t)=>{const n=H.value.find((e=>e.originFileObj===t));n&&(n.status="error"),s.Z.error({message:"上传进度提醒",description:`上传${null==t?void 0:t.name}文件失败！错误信息：${614===e.code?"上传文件已存在":e.message}`,duration:0})},F=e=>{const t=H.value.find((t=>t.originFileObj===e));t&&(t.status="success"),s.Z.success({message:`上传${null==t?void 0:t.name}成功`})},C=async()=>{if(k.value.length<=0)return;const e=k.value,t=y.value;if(k.value=[],y.value=[],e.length!==t.length)for(let t=0;t<e.length;t++)e[t].unsubscribe(),e[t]=null;await(0,a.Y3)(),u("changed")};return n({open:e=>{Z.value=e,W.value=!0,_.value=!0,h._M().then((e=>{b.value=e.token,_.value=!1})).catch((()=>{W.value=!1}))}}),(e,t)=>((0,a.wg)(),(0,a.iD)("div",p,[(0,a.Wm)((0,l.SU)(d.Z),{title:(0,l.SU)(U),width:400,visible:W.value,"mask-closable":!1,onClose:$},{default:(0,a.w5)((()=>[(0,a.Wm)((0,l.SU)(f.Z),{spinning:_.value,class:"upload-inner-box"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,l.SU)(v.Z).Dragger,{ref_key:"uploadRef",ref:m,"file-list":H.value,"onUpdate:file-list":t[0]||(t[0]=e=>H.value=e),class:"upload",drag:"",action:"noaction",multiple:!0,"custom-request":x},{default:(0,a.w5)((()=>[g,w])),_:1},8,["file-list"])])),_:1},8,["spinning"])])),_:1},8,["title","visible"])]))}}),u()}catch(e){u(e)}}))},9525:function(e,t,n){n.a(e,(async function(e,u){try{n.d(t,{DR:function(){return i},E9:function(){return s},LI:function(){return m},Nk:function(){return h},Sv:function(){return f},_M:function(){return c},gQ:function(){return v},i$:function(){return o},m0:function(){return p},n0:function(){return d}});var a=n(4064),l=n(34470),r=e([a]);function i(e){return(0,a.W)({url:l.default.list,method:"get",params:e})}function o(e){return(0,a.W)({url:l.default.mkdir,method:"post",data:e})}function c(){return(0,a.W)({url:l.default.token,method:"get"})}function s(e){return(0,a.W)({url:l.default.info,method:"post",data:e})}function d(e){return(0,a.W)({url:l.default.mark,method:"post",data:e})}function f(e){return(0,a.W)({url:l.default.download,method:"post",data:e})}function v(e){return(0,a.W)({url:l.default.rename,method:"post",data:e})}function h(e){return(0,a.W)({url:l.default.delete,method:"post",data:e})}function m(e){return(0,a.W)({url:l.default.cut,method:"post",data:e})}function p(e){return(0,a.W)({url:l.default.copy,method:"post",data:e})}a=(r.then?(await r)():r)[0],u()}catch(g){u(g)}}))},5014:function(e,t,n){n.a(e,(async function(e,u){try{n.r(t);var a=n(67782),l=e([a]);const r=(a=(l.then?(await l)():l)[0]).Z;t.default=r,u()}catch(e){u(e)}}))},67782:function(e,t,n){n.a(e,(async function(e,u){try{n.d(t,{Z:function(){return a.Z}});var a=n(6957),l=e([a]);a=(l.then?(await l)():l)[0],u()}catch(e){u(e)}}))}}]);