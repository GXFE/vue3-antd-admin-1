"use strict";(self.webpackChunkvue3_antd_admin=self.webpackChunkvue3_antd_admin||[]).push([[6501,4862,1415,6173,9400,4118,4809,1610],{68868:function(e,t,n){n.a(e,(async function(e,a){try{n(85827),n(57658);var r=n(66252),u=n(2262),d=n(34118),o=n(14809),l=n(27623),c=n(31136),i=n(76496),s=n(21502),f=n(46945),p=n(12746),h=e([l,c,i,s,f]);[l,c,i,s,f]=h.then?(await h)():h;const m=(0,r.aZ)({name:"SystemPermissionRole"});t.Z=(0,r.aZ)({...m,setup(e){const[t,n]=(0,s.useTable)(),[a]=(0,f.U)(),h=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return t.reduce(((t,a)=>{var r;return null!==(r=a.children)&&void 0!==r&&r.length?h(e,a.children,n):e.includes(a.value)&&t.push(a.value),t}),n)},m=async e=>{const[t]=await a({modalProps:{title:(e.id?"编辑":"新增")+"角色",width:"50%",onFinish:async a=>{e.id&&(a.roleId=e.id);const r=null==t?void 0:t.compRefMap.get("menus"),u=null==t?void 0:t.compRefMap.get("depts"),d={...a,menus:[...r.halfCheckedKeys,...r.checkedKeys],depts:[...u.halfCheckedKeys,...u.checkedKeys]};await(e.id?l.ul:l.fA)(d),null==n||n.reload()}},formProps:{labelWidth:100,schemas:o.roleSchemas}}),[r,u]=await Promise.all([(0,c.U4)(),(0,i.Af)()]),d=(0,p.bl)(u),s=(0,p.fl)(r);if(null==t||t.updateSchema([{field:"menus",componentProps:{treeData:d}},{field:"depts",componentProps:{treeData:s}}]),e.id){const n=await(0,l.Xt)({roleId:e.id}),a=n.menus.map((e=>e.menuId)),r=n.depts.map((e=>e.departmentId));null==t||t.setFieldsValue({...e,name:n.roleInfo.name,label:n.roleInfo.label,remark:n.roleInfo.remark,menus:h(a,d),depts:h(r,s)})}},y=[...d.baseColumns,{title:"操作",width:160,dataIndex:"ACTION",hideInSearch:!0,align:"center",fixed:"right",actions:e=>{let{record:t}=e;return[{label:"编辑",auth:{perm:"sys.role.update",effect:"disable"},onClick:()=>m(t)},{label:"删除",auth:"sys.role.delete",popConfirm:{title:"你确定要删除吗？",onConfirm:()=>(async e=>{await(0,l.Rd)({roleIds:[e.id]}),null==n||n.reload()})(t)}}]}}];return(e,n)=>{const a=(0,r.up)("a-button");return(0,r.wg)(),(0,r.iD)("div",null,[(0,r.Wm)((0,u.SU)(t),{"row-key":"id","header-title":"角色管理","data-request":(0,u.SU)(l.$s),columns:y,bordered:"",size:"small"},{toolbar:(0,r.w5)((()=>[(0,r.Wm)(a,{type:"primary",disabled:!e.$auth("sys.role.add"),onClick:n[0]||(n[0]=e=>m({}))},{default:(0,r.w5)((()=>[(0,r.Uk)(" 新增 ")])),_:1},8,["disabled"])])),_:1},8,["data-request"])])}}}),a()}catch(e){a(e)}}))},31136:function(e,t,n){n.a(e,(async function(e,a){try{n.d(t,{MB:function(){return c},U4:function(){return o},UJ:function(){return i},aS:function(){return l},m3:function(){return s}});var r=n(4064),u=n(27301),d=e([r]);function o(){return(0,r.W)({url:u.default.list,method:"get"})}function l(e){return(0,r.W)({url:"sys/dept/delete",method:"post",data:e},{successMsg:"删除成功"})}function c(e){return(0,r.W)({url:u.default.update,method:"post",data:e})}function i(e){return(0,r.W)({url:u.default.add,method:"post",data:e})}function s(e){return(0,r.W)({url:u.default.transfer,method:"post",data:e})}r=(d.then?(await d)():d)[0],a()}catch(f){a(f)}}))},76496:function(e,t,n){n.a(e,(async function(e,a){try{n.d(t,{Af:function(){return o},RD:function(){return i},ZT:function(){return l},_8:function(){return c}});var r=n(4064),u=n(57314),d=e([r]);function o(){return(0,r.W)({url:u.default.list,method:"get"})}function l(e){return(0,r.W)({url:u.default.add,method:"post",data:e},{successMsg:"创建成功"})}function c(e){return(0,r.W)({url:u.default.update,method:"post",data:e},{successMsg:"更新成功"})}function i(e){return(0,r.W)({url:u.default.delete,method:"post",data:e},{successMsg:"删除成功"})}r=(d.then?(await d)():d)[0],a()}catch(s){a(s)}}))},27623:function(e,t,n){n.a(e,(async function(e,a){try{n.d(t,{$s:function(){return c},JV:function(){return l},Rd:function(){return f},Xt:function(){return o},fA:function(){return i},ul:function(){return s}});var r=n(4064),u=n(15322),d=e([r]);function o(e){return(0,r.W)({url:u.default.info,method:"get",params:e})}function l(e){return(0,r.W)({url:u.default.list,method:"get",data:e})}function c(e){return(0,r.W)({url:u.default.page,method:"get",params:e})}function i(e){return(0,r.W)({url:u.default.add,method:"post",data:e},{successMsg:"创建角色成功"})}function s(e){return(0,r.W)({url:u.default.update,method:"post",data:e},{successMsg:"更新角色成功"})}function f(e){return(0,r.W)({url:u.default.delete,method:"post",data:e},{successMsg:"删除角色成功"})}r=(d.then?(await d)():d)[0],a()}catch(p){a(p)}}))},14809:function(e,t,n){n.r(t),n.d(t,{roleSchemas:function(){return a}});const a=[{field:"name",component:"Input",label:"名称",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"label",component:"Input",label:"标识",rules:[{required:!0,type:"string"}],colProps:{span:12}},{field:"remark",component:"InputTextArea",label:"备注"},{field:"menus",component:"Tree",label:"菜单权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"350px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}},{field:"depts",component:"Tree",label:"部门权限",colProps:{span:12},componentProps:{checkable:!0,vModelKey:"checkedKeys",style:{height:"350px",paddingTop:"5px",overflow:"auto",borderRadius:"6px",border:"1px solid #dcdfe6"}}}]},34118:function(e,t,n){n.r(t),n.d(t,{baseColumns:function(){return a}});const a=[{title:"#",dataIndex:"id",width:55,align:"center",hideInSearch:!0},{title:"名称",width:200,align:"center",dataIndex:"name"},{title:"标识",width:80,align:"center",dataIndex:"label"},{title:"备注",dataIndex:"remark",align:"center"},{title:"创建时间",dataIndex:"createdAt",align:"center",hideInSearch:!0},{title:"更新时间",align:"center",dataIndex:"updatedAt",hideInSearch:!0}]},39623:function(e,t,n){n.a(e,(async function(e,a){try{n.r(t);var r=n(57627),u=e([r]);const d=(r=(u.then?(await u)():u)[0]).Z;t.default=d,a()}catch(e){a(e)}}))},57627:function(e,t,n){n.a(e,(async function(e,a){try{n.d(t,{Z:function(){return r.Z}});var r=n(68868),u=e([r]);r=(u.then?(await u)():u)[0],a()}catch(e){a(e)}}))}}]);